{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport React from \"react\";\nimport { StatusBar } from \"expo-status-bar\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport Keyboard from \"react-native-web/dist/exports/Keyboard\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport { Icon, withTheme } from \"@rneui/themed\";\nimport { LinearGradient } from \"expo-linear-gradient\";\nimport COLORS from \"../components/Colors\";\nimport Button from \"../components/Button\";\nimport Input from \"../components/Input\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\n\nvar Login = function Login(_ref) {\n  var navigation = _ref.navigation;\n\n  var _React$useState = React.useState({\n    usuario: \"jiep17\",\n    contraseña: \"12345678\"\n  }),\n      _React$useState2 = _slicedToArray(_React$useState, 2),\n      inputs = _React$useState2[0],\n      setInputs = _React$useState2[1];\n\n  var _React$useState3 = React.useState({}),\n      _React$useState4 = _slicedToArray(_React$useState3, 2),\n      errors = _React$useState4[0],\n      setErrors = _React$useState4[1];\n\n  var _React$useState5 = React.useState(false),\n      _React$useState6 = _slicedToArray(_React$useState5, 2),\n      loading = _React$useState6[0],\n      setLoading = _React$useState6[1];\n\n  var validate = function _callee() {\n    var headersList, response, data, isValid;\n    return _regeneratorRuntime.async(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            headersList = {\n              \"Accept\": \"*/*\"\n            };\n            _context.next = 3;\n            return _regeneratorRuntime.awrap(fetch(\"http://localhost:4000/users\", {\n              method: \"GET\",\n              headers: headersList\n            }));\n\n          case 3:\n            response = _context.sent;\n            _context.next = 6;\n            return _regeneratorRuntime.awrap(response.text());\n\n          case 6:\n            data = _context.sent;\n            console.log(data);\n            Keyboard.dismiss();\n            isValid = true;\n\n            if (!inputs.usuario) {\n              handleError(\"Ingrese su usuario\", \"usuario\");\n              isValid = false;\n            }\n\n            if (!inputs.contraseña) {\n              handleError(\"Ingrese su contraseña\", \"contraseña\");\n              isValid = false;\n            } else if (inputs.contraseña.length < 8) {\n              handleError(\"La longitud mínima de la constraseña es 8\", \"contraseña\");\n              isValid = false;\n            }\n\n            if (isValid) {\n              login();\n            }\n\n          case 13:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  var login = function login() {\n    setTimeout(function _callee2() {\n      var userData;\n      return _regeneratorRuntime.async(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              setLoading(false);\n              _context2.next = 3;\n              return _regeneratorRuntime.awrap(AsyncStorage.getItem(\"userData\"));\n\n            case 3:\n              userData = _context2.sent;\n\n              if (userData) {\n                userData = JSON.parse(userData);\n\n                if (inputs.usuario == userData.usuario && inputs.contraseña == userData.contraseña) {\n                  navigation.navigate(\"Inicio\");\n                  AsyncStorage.setItem(\"userData\", JSON.stringify(_objectSpread(_objectSpread({}, userData), {}, {\n                    loggedIn: true\n                  })));\n                } else {\n                  Alert.alert(\"Error\", \"Datos ingresados incorrectos\");\n                }\n              } else {\n                Alert.alert(\"Error\", \"User does not exist\");\n              }\n\n            case 5:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    }, 10);\n  };\n\n  var handleOnchange = function handleOnchange(text, input) {\n    setInputs(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, input, text));\n    });\n  };\n\n  var handleError = function handleError(error, input) {\n    setErrors(function (prevState) {\n      return _objectSpread(_objectSpread({}, prevState), {}, _defineProperty({}, input, error));\n    });\n  };\n\n  return _jsx(SafeAreaView, {\n    style: {\n      backgroundColor: withTheme,\n      flex: 1\n    },\n    children: _jsxs(View, {\n      style: {\n        paddingTop: 50,\n        paddingHorizontal: 20\n      },\n      children: [_jsx(Text, {\n        style: {\n          color: withTheme,\n          fontSize: 40,\n          fontWeight: \"bold\"\n        },\n        children: \"MINSAPP\"\n      }), _jsxs(View, {\n        style: {\n          marginVertical: 20\n        },\n        children: [_jsx(Input, {\n          onChangeText: function onChangeText(text) {\n            return handleOnchange(text, \"usuario\");\n          },\n          onFocus: function onFocus() {\n            return handleError(null, \"usuario\");\n          },\n          iconName: \"account-circle\",\n          label: \"Usuario\",\n          placeholder: \"Ingresa tu usuario\",\n          error: errors.usuario\n        }), _jsx(Input, {\n          onChangeText: function onChangeText(text) {\n            return handleOnchange(text, \"contraseña\");\n          },\n          onFocus: function onFocus() {\n            return handleError(null, \"contraseña\");\n          },\n          iconName: \"lock-outline\",\n          label: \"Contrase\\xF1a\",\n          placeholder: \"Ingresa tu contrase\\xF1a\",\n          error: errors.contraseña,\n          password: true\n        }), _jsx(Button, {\n          title: \"Entrar\",\n          onPress: validate\n        }), _jsx(Text, {\n          onPress: function onPress() {\n            return navigation.navigate(\"Registro\");\n          },\n          style: {\n            color: COLORS.black,\n            fontWeight: \"bold\",\n            textAlign: \"center\",\n            fontSize: 16\n          },\n          children: \"\\xBFA\\xFAn no tienes una cuenta? Registrate\"\n        })]\n      })]\n    })\n  });\n};\n\nexport default Login;","map":{"version":3,"names":["React","StatusBar","Icon","withTheme","LinearGradient","COLORS","Button","Input","AsyncStorage","Login","navigation","useState","usuario","contraseña","inputs","setInputs","errors","setErrors","loading","setLoading","validate","headersList","fetch","method","headers","response","text","data","console","log","Keyboard","dismiss","isValid","handleError","length","login","setTimeout","getItem","userData","JSON","parse","navigate","setItem","stringify","loggedIn","Alert","alert","handleOnchange","input","prevState","error","backgroundColor","flex","paddingTop","paddingHorizontal","color","fontSize","fontWeight","marginVertical","black","textAlign"],"sources":["E:/escritorio/Taller-Spring1/APP_OCR_APP/AppOCR/Frontend/screen/Login.js"],"sourcesContent":["import React from \"react\";\r\nimport { StatusBar } from \"expo-status-bar\";\r\nimport {\r\n  Alert,\r\n  Keyboard,\r\n  StyleSheet,\r\n  SafeAreaView,\r\n  View,\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n} from \"react-native\";\r\nimport { Icon, withTheme } from \"@rneui/themed\";\r\nimport { LinearGradient } from \"expo-linear-gradient\";\r\n// import response from \"../services/userService\";\r\n\r\nimport COLORS from \"../components/Colors\";\r\nimport Button from \"../components/Button\";\r\nimport Input from \"../components/Input\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\n//import Icon from 'react-native-vector-icons/MaterialCommunityIcons'\r\n\r\nconst Login = ({ navigation }) => {\r\n  const [inputs, setInputs] = React.useState({ usuario: \"jiep17\", contraseña: \"12345678\" });\r\n  const [errors, setErrors] = React.useState({});\r\n  const [loading, setLoading] = React.useState(false);\r\n\r\n  const validate = async () => {\r\n    \r\n  let headersList = {\r\n      \"Accept\": \"*/*\",\r\n  }\r\n     \r\n  let response = await fetch(\"http://localhost:4000/users\", { \r\n       method: \"GET\",\r\n       headers: headersList\r\n  });\r\n  let data = await response.text();\r\n  console.log(data);\r\n\r\n    Keyboard.dismiss();\r\n    let isValid = true;\r\n    if (!inputs.usuario) {\r\n      handleError(\"Ingrese su usuario\", \"usuario\");\r\n      isValid = false;\r\n    }\r\n    if (!inputs.contraseña) {\r\n      handleError(\"Ingrese su contraseña\", \"contraseña\");\r\n      isValid = false;\r\n    } else if (inputs.contraseña.length < 8) {\r\n      handleError(\"La longitud mínima de la constraseña es 8\", \"contraseña\");\r\n      isValid = false;\r\n    }\r\n\r\n    if (isValid) {\r\n      login();\r\n    }\r\n  };\r\n\r\n  const login = () => {\r\n    //setLoading(true);\r\n    setTimeout(async () => {\r\n      setLoading(false);\r\n      let userData = await AsyncStorage.getItem(\"userData\");\r\n      if (userData) {\r\n        userData = JSON.parse(userData);\r\n        if (\r\n          inputs.usuario == userData.usuario &&\r\n          inputs.contraseña == userData.contraseña\r\n        ) {\r\n          navigation.navigate(\"Inicio\");\r\n          AsyncStorage.setItem(\r\n            \"userData\",\r\n            JSON.stringify({ ...userData, loggedIn: true })\r\n          );\r\n        } else {\r\n          Alert.alert(\r\n            \"Error\",\r\n            \"Datos ingresados incorrectos\"\r\n          );\r\n        }\r\n      } else {\r\n        Alert.alert(\"Error\", \"User does not exist\");\r\n      }\r\n    }, 10);\r\n  };\r\n\r\n  const handleOnchange = (text, input) => {\r\n    setInputs((prevState) => ({ ...prevState, [input]: text }));\r\n  };\r\n\r\n  const handleError = (error, input) => {\r\n    setErrors((prevState) => ({ ...prevState, [input]: error }));\r\n  };\r\n\r\n  return (\r\n    <SafeAreaView style={{ backgroundColor: withTheme, flex: 1 }}>\r\n      <View style={{ paddingTop: 50, paddingHorizontal: 20 }}>\r\n        <Text style={{ color: withTheme, fontSize: 40, fontWeight: \"bold\" }}>\r\n          MINSAPP\r\n        </Text>\r\n\r\n        <View style={{ marginVertical: 20 }}>\r\n          <Input\r\n            onChangeText={(text) => handleOnchange(text, \"usuario\")}\r\n            onFocus={() => handleError(null, \"usuario\")}\r\n            iconName=\"account-circle\"\r\n            label=\"Usuario\"\r\n            placeholder=\"Ingresa tu usuario\"\r\n            error={errors.usuario}\r\n          />\r\n          <Input\r\n            onChangeText={(text) => handleOnchange(text, \"contraseña\")}\r\n            onFocus={() => handleError(null, \"contraseña\")}\r\n            iconName=\"lock-outline\"\r\n            label=\"Contraseña\"\r\n            placeholder=\"Ingresa tu contraseña\"\r\n            error={errors.contraseña}\r\n            password\r\n          />\r\n          <Button title=\"Entrar\" onPress={validate} />\r\n          <Text\r\n            onPress={() => navigation.navigate(\"Registro\")}\r\n            style={{\r\n              color: COLORS.black,\r\n              fontWeight: \"bold\",\r\n              textAlign: \"center\",\r\n              fontSize: 16,\r\n            }}\r\n          >\r\n            ¿Aún no tienes una cuenta? Registrate\r\n          </Text>\r\n        </View>\r\n      </View>\r\n    </SafeAreaView>\r\n  );\r\n};\r\n\r\nexport default Login;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}